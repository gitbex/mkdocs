{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"AWS MFA Setup Guide","text":"<p>All users must enable Multi-Factor Authentication (MFA) to access AWS resources.</p> <p>Without MFA, you will see \"Access Denied\" errors for most AWS services. You'll only be able to set up MFA until it's enabled.</p>"},{"location":"#before-you-start","title":"Before You Start","text":"<p>You'll need: - Your AWS username and password - A smartphone with one of these apps installed:   - Google Authenticator (recommended)   - Microsoft Authenticator   - Authy</p> <p>Time needed: 5 minutes</p>"},{"location":"#setup-instructions","title":"Setup Instructions","text":""},{"location":"#step-1-click-add-mfa-on-the-dashboard","title":"Step 1: Click \"Add MFA\" on the Dashboard","text":"<ol> <li>Log into AWS Console: <code>https://629070900093.signin.aws.amazon.com/console</code></li> <li>After logging in, you'll see the IAM Dashboard</li> <li>Look for the orange \"Add MFA\" button in the \"Security recommendations\" section (see Image 1)</li> <li>Click Add MFA</li> </ol> <p>What you'll see: The IAM Dashboard will show \"Add MFA for\" button.</p>"},{"location":"#step-2-choose-your-mfa-device-type","title":"Step 2: Choose Your MFA Device Type","text":"<p>You'll see the \"Select MFA device\" page with two steps on the left.</p> <p>Fill in the form:</p> <ol> <li>Device name: Type a name like \"My Phone\" or \"iPhone\"</li> <li>MFA device: Select \"Authenticator app\" or other option</li> <li>Click Next</li> </ol> <p>What you'll see</p> <p>Three device options: - Passkey - Authenticator app - Hardware token</p>"},{"location":"#step-3-scan-qr-code-with-your-phone","title":"Step 3: Scan QR Code with Your Phone","text":"<p>The next screen shows a QR code.</p> <p>On your phone: 1. Open your authenticator app (Google Authenticator, etc.) 2. Tap the + or \"Add account\" button 3. Choose \"Scan QR code\" 4. Point your camera at the QR code on your computer screen 5. The app will automatically add \"AWS:your-username\"  </p> <p>Now you'll see a 6-digit code in your app that changes every 30 seconds.</p>"},{"location":"#step-4-enter-two-mfa-codes","title":"Step 4: Enter Two MFA Codes","text":"<p>Back on your computer:</p> <ol> <li>Look at your authenticator app - copy the 6-digit code</li> <li>Enter it in \"MFA code 1\"</li> <li>Wait 30 seconds for the code to change</li> <li>Enter the new code in \"MFA code 2\"</li> <li>Click Add MFA</li> </ol> <p>Important</p> <p>You must use two different codes. If the code changes while you're typing, start over with the new code</p>"},{"location":"#step-5-success-mfa-is-enabled","title":"Step 5: Success! MFA is Enabled","text":"<p>You'll see a green banner at the top: \"Passkey MFA device assigned\"</p> <p>The page will show your security credentials without any \"Access Denied\" errors.</p> <p>What you'll see: Green success message at the top and \"Console password\" section will no longer show access denied errors (see Image 2).</p> <p>That's it! MFA is now enabled.</p>"},{"location":"#testing-your-mfa","title":"Testing Your MFA","text":"<p>To make sure everything works:</p> <ol> <li>Click your username (top right) \u2192 Sign out</li> <li>Log in again with:</li> <li>Your username</li> <li>Your password  </li> <li>6-digit code from your authenticator app</li> <li>You should now have full access without \"Access Denied\" errors!</li> </ol>"},{"location":"#daily-login-after-mfa-is-enabled","title":"Daily Login After MFA is Enabled","text":"<p>From now on, when you log in:</p> <ol> <li>Enter your username</li> <li>Enter your password</li> <li>Open your authenticator app and enter the 6-digit code</li> <li>Click Sign In</li> </ol> <p>The code changes every 30 seconds, so type it quickly!</p>"},{"location":"#troubleshooting","title":"Troubleshooting","text":""},{"location":"#invalid-mfa-code-error","title":"Invalid MFA code - error","text":"<p>Try this: - Wait for a new code (they expire every 30 seconds) - Make sure your phone's time is set to automatic - Don't use the same code twice</p>"},{"location":"#lost-your-phone-or-got-a-new-one","title":"Lost your phone or got a new one","text":"<p>Contact your AWS administrator to help you remove the old device and set up a new one.</p>"},{"location":"#still-seeing-access-denied-after-setup","title":"Still seeing 'Access Denied' after setup","text":"<ol> <li>Log out completely</li> <li>Log back in with username + password + MFA code</li> <li>If still blocked, contact your AWS administrator</li> </ol>"},{"location":"#need-help","title":"Need Help?","text":"<p>Common Questions:</p> <p>Q: Can I use text messages instead of an app? A: No, we require authenticator apps for better security.</p> <p>Q: What if I don't set up MFA? A: You'll be locked out of AWS until you complete the setup.</p> <p>Q: My code doesn't work! A: Make sure your phone's time is set to automatic and wait for a fresh code.</p> <p>Q: I lost my phone, what do I do? A: Contact your AWS administrator immediately to reset your MFA device.</p> <p>Need help? Contact your AWS administrator.  </p> <p>Link to official workshop</p>"},{"location":"cli/","title":"AWS MFA Authentication Guide","text":"<p>Quick guide for authenticating with AWS using Multi-Factor Authentication (MFA).</p>"},{"location":"cli/#prerequisites","title":"Prerequisites","text":"<ul> <li>AWS CLI installed</li> <li>MFA device configured</li> <li><code>jq</code> installed (for scripts)</li> </ul>"},{"location":"cli/#three-ways-to-authenticate","title":"Three Ways to Authenticate","text":"<p>Get MFA device Identifier <pre><code>aws iam list-mfa-devices --user-name some-user --profile datatruck\n</code></pre></p>"},{"location":"cli/#option-1-environment-variables-fastest","title":"Option 1: Environment Variables (Fastest)","text":""},{"location":"cli/#step-1-get-credentials","title":"Step 1: Get credentials","text":"<pre><code>aws sts get-session-token \\\n  --serial-number arn:aws:iam::ACCOUNT_ID:mfa/USERNAME \\\n  --token-code 123456 \\\n  --duration-seconds 129600 \\\n  --profile YOUR_PROFILE\n</code></pre>"},{"location":"cli/#step-2-export-to-terminal","title":"Step 2: Export to terminal","text":"<pre><code>export AWS_ACCESS_KEY_ID=\"ASIA...\"\nexport AWS_SECRET_ACCESS_KEY=\"...\"\nexport AWS_SESSION_TOKEN=\"...\"\n</code></pre>"},{"location":"cli/#step-3-use-aws-cli","title":"Step 3: Use AWS CLI","text":"<pre><code>aws lambda list-functions\naws s3 ls\n</code></pre> <p>Note</p> <p>Lost when terminal closes</p>"},{"location":"cli/#option-2-automated-script-recommended","title":"Option 2: Automated Script (Recommended)","text":"<p>Best for: Daily development work</p>"},{"location":"cli/#create-script-aws-mfash","title":"Create script <code>~/aws-mfa.sh</code>","text":"<pre><code>#!/bin/bash\n\n# Configuration\nMFA_SERIAL=\"arn:aws:iam::ACCOUNT_ID:mfa/USERNAME\"\nBASE_PROFILE=\"your-profile\"\n\n# Get MFA code\nread -p \"Enter MFA code: \" MFA_CODE\n\n# Get credentials\necho \"Getting credentials...\"\nOUTPUT=$(aws sts get-session-token \\\n  --serial-number $MFA_SERIAL \\\n  --token-code $MFA_CODE \\\n  --duration-seconds 129600 \\\n  --profile $BASE_PROFILE)\n\n# Export to environment\nexport AWS_ACCESS_KEY_ID=$(echo $OUTPUT | jq -r '.Credentials.AccessKeyId')\nexport AWS_SECRET_ACCESS_KEY=$(echo $OUTPUT | jq -r '.Credentials.SecretAccessKey')\nexport AWS_SESSION_TOKEN=$(echo $OUTPUT | jq -r '.Credentials.SessionToken')\n\necho \"\u2705 Done! Credentials valid for 36 hours\"\n</code></pre>"},{"location":"cli/#make-executable-and-use","title":"Make executable and use","text":"<pre><code>chmod +x ~/aws-mfa.sh\n\n# Run with source\nsource ~/aws-mfa.sh\n\n# Or create alias\necho 'alias aws-mfa=\"source ~/aws-mfa.sh\"' &gt;&gt; ~/.bashrc\n</code></pre> <p>Note</p> <p>Need to run in each new terminal</p>"},{"location":"cli/#option-3-named-profile","title":"Option 3: Named Profile","text":"<p>Multiple accounts, persistent credentials</p>"},{"location":"cli/#step-1-get-credentials_1","title":"Step 1: Get credentials","text":"<pre><code>aws sts get-session-token \\\n  --serial-number arn:aws:iam::ACCOUNT_ID:mfa/USERNAME \\\n  --token-code 123456 \\\n  --duration-seconds 129600 \\\n  --profile YOUR_PROFILE\n</code></pre>"},{"location":"cli/#step-2-add-to-awscredentials","title":"Step 2: Add to <code>~/.aws/credentials</code>","text":"<pre><code>[your-profile-mfa]\naws_access_key_id = ASIA...\naws_secret_access_key = ...\naws_session_token = ...\n</code></pre>"},{"location":"cli/#step-3-use-with-profile-flag","title":"Step 3: Use with profile flag","text":"<pre><code>aws lambda list-functions --profile your-profile-mfa\n</code></pre> <p>Note</p> <p>Persists across terminals, works with all tools  </p>"},{"location":"cli/#common-issues","title":"Common Issues","text":""},{"location":"cli/#multifactorauthentication-failed","title":"MultiFactorAuthentication failed","text":"<ul> <li>MFA code expired (try a fresh one)</li> <li>Check system time: <code>date</code></li> <li>Verify MFA device: <code>aws iam list-mfa-devices --user-name USERNAME</code></li> </ul>"},{"location":"cli/#expiredtoken-error","title":"ExpiredToken error","text":"<p>Your credentials expired. Re-run the authentication with a new MFA code.</p>"},{"location":"cli/#find-your-mfa-device-arn","title":"Find your MFA device ARN","text":"<pre><code>aws iam list-mfa-devices --user-name USERNAME\n</code></pre>"},{"location":"cli/#security-tips","title":"Security Tips","text":"<ul> <li>Maximum duration: 36 hours (129600 seconds)</li> <li>Never commit credentials to git</li> <li>Use separate profiles for different accounts</li> <li>Credentials auto-expire (safer than permanent keys)</li> </ul>"},{"location":"cli/#team-setup","title":"Team Setup","text":"<p>Recommended profile naming:</p> <pre><code>[datatruck]           # Base credentials\n[datatruck-mfa]       # Temporary MFA credentials\n\n[production]          # Base credentials  \n[production-mfa]      # Temporary MFA credentials\n</code></pre>"},{"location":"cwagent/","title":"AWS CloudWatch Agent Configuration","text":""},{"location":"cwagent/#disk-and-memory-metrics","title":"Disk and Memory Metrics","text":"<p>This document outlines the steps to configure the CloudWatch Agent to collect essential Disk and Memory utilization metrics from EC2 instances, ensuring we only collect the necessary data.</p>"},{"location":"cwagent/#1-the-minimized-configuration-file","title":"1. The Minimized Configuration File","text":"<p>The configuration below is saved as cloudwatch-agent.json in the <code>/opt/aws/amazon-cloudwatch-agent/etc/</code> directory. It is scoped only to collect memory and disk metrics.  </p> <p>If you create or edit the agent configuration file manually, you can give it any name. For simplicity in troubleshooting, we recommend that you name it /opt/aws/  amazon-cloudwatch-agent/etc/cloudwatch-agent.json on a Linux server and $Env:ProgramData\\Amazon\\AmazonCloudWatchAgent\\amazon-cloudwatch-agent.json on servers running Windows Server.   After you have created the file, you can copy it to other servers where you want to install the agent.  </p> <p>Create and add permissoins  </p> <pre><code>sudo nano cloudwatch-agent.json\nsudo chown cwagent:cwagent cloudwatch-agent.json\nsudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \\\n    -a fetch-config \\\n    -m ec2 \\\n    -s \\\n    -c file:/opt/aws/amazon-cloudwatch-agent/etc/cloudwatch-agent.json\n</code></pre> <p>Add template to config file  </p> <pre><code>{\n  \"agent\": {\n    \"metrics_collection_interval\": 60,\n    \"region\": \"us-east-2\",\n    \"logfile\": \"/opt/aws/amazon-cloudwatch-agent/logs/amazon-cloudwatch-agent.log\",\n    \"debug\": false,\n    \"run_as_user\": \"cwagent\"\n  },\n  \"metrics\": {\n    \"namespace\": \"CWAgent\",\n    \"metrics_collected\": {\n      \"disk\": {\n        \"measurement\": [\n          \"disk_used_percent\",\n          \"disk_free\"\n        ],\n        \"metrics_collection_interval\": 60,\n        \"resources\": [\n          \"*\"\n        ],\n        \"ignore_file_system_types\": [\n          \"sysfs\",\n          \"devtmpfs\",\n          \"overlay\"\n        ]\n      },\n      \"mem\": {\n        \"measurement\": [\n          \"mem_used_percent\"\n        ],\n        \"metrics_collection_interval\": 60\n      }\n    },\n    \"append_dimensions\": {\n      \"ImageId\": \"${aws:ImageId}\",\n      \"InstanceId\": \"${aws:InstanceId}\",\n      \"InstanceType\": \"${aws:InstanceType}\",\n      \"AutoScalingGroupName\": \"${aws:AutoScalingGroupName}\"\n    }\n  }\n}\n</code></pre>"},{"location":"cwagent/#2-apply-and-start-the-agent-configuration","title":"2. Apply and Start the Agent Configuration","text":"<p>The configuration is applied using the <code>amazon-cloudwatch-agent-ctl</code> utility.</p> LinuxWindows <pre><code>sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \\\n-a fetch-config \\\n-m ec2 \\\n-s \\\n-c file:/opt/aws/amazon-cloudwatch-agent/etc/cloudwatch-agent.json\n</code></pre> <pre><code>&amp; \"C:\\Program Files\\Amazon\\AmazonCloudWatchAgent\\amazon-cloudwatch-agent-ctl.ps1\" \\\n-a fetch-config \\\n-m ec2 \\\n-s \\\n-c file:\"C:\\path\\to\\cloudwatch-agent.json\"\n</code></pre>"},{"location":"cwagent/#3-verify-agent-status","title":"3. Verify Agent Status","text":"<p>After running the command above, confirm the agent is running and configured correctly.</p> <p>Check Status <pre><code>sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -m ec2 -a status\n</code></pre></p> <p>Expected Output:</p> <pre><code>{\n  \"status\": \"running\",\n  \"configstatus\": \"configured\",\n  \"version\": \"...\"\n}\n</code></pre> <p>Check Agent Logs for Errors Check the agent log file (after at least one minute to ensure a collection cycle has occurred) to look for any new errors:</p> <pre><code>tail -n 20 /opt/aws/amazon-cloudwatch-agent/logs/amazon-cloudwatch-agent.log | grep -i 'error'\n</code></pre> <ul> <li>Expected Behavior:  No output, or only informational messages</li> </ul> <p>Link for official documentation</p>"}]}